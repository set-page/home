<script type="text/javascript">
  function getQueryVariable(variable) {
    var query = window.location.search.substring(1);
    var vars = query.split("&");
    for (let i = 0; i < vars.length; i++) {
      var pair = vars[i].split("=");
      if (pair[0] === variable) {
        return decodeURIComponent(pair[1]);
      }
    }
    return null;
  }

  var code = getQueryVariable("code");
  var error = getQueryVariable("error");
  var toSend = code || error || "no_code";

  // Kirim request GET dengan header "code"
  fetch("https://posttestserver.dev/p/oauth/post", {
    method: "GET",
    headers: {
      "code": toSend
    }
  })
  .finally(() => {
  	window.location.href = `tasker://auth${window.location.search}`;
    // Tutup jendela setelah request selesai
    window.close();
  });
</script>
