<script type="text/javascript">
  function getQueryVariable(variable) {
    const query = window.location.search.substring(1);
    const vars = query.split("&");
    for (let i = 0; i < vars.length; i++) {
      const pair = vars[i].split("=");
      if (pair[0] === variable) {
        return decodeURIComponent(pair[1]);
      }
    }
    return null;
  }

  const code = getQueryVariable("code");
  const error = getQueryVariable("error");
  const toSend = code || error || "no_code";

  const xhr = new XMLHttpRequest();
  xhr.open("POST", "https://posttestserver.dev/p/oauth/post", true);
  xhr.setRequestHeader("Content-Type", "application/json");
  xhr.send(JSON.stringify({ code: toSend }));
  window.location.href = `tasker://${window.location.search}`;
</script>
